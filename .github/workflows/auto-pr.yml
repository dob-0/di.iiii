name: Auto PR devâ†’main

on:
  push:
    branches: [ dev ]
  workflow_dispatch:

jobs:
  create-pull-request:
    runs-on: ubuntu-latest
    steps:
      - name: Create PR from dev to main
        uses: actions/github-script@v7
        with:
          script: |
            const { owner, repo } = context.repo;
            const head = 'dev';
            const base = 'main';
            const title = 'feat: visible default scene + dev auto-open path';
            const body = `\nSummary: New/cleared scenes are visible; skip server reload after clear; stronger grid and aligned camera; dev server auto-opens chosen path.\n\nIncludes: default scene + camera updates, clear logic fixes, grid color/appearance, vite auto-open env, CI + release workflows.`;

            // Check if a PR already exists
            const prs = await github.rest.pulls.list({ owner, repo, state: 'open', head: `${owner}:${head}`, base });
            if (prs.data && prs.data.length > 0) {
              core.info(`PR already exists: ${prs.data[0].html_url}`);
            } else {
              const res = await github.rest.pulls.create({ owner, repo, title, head, base, body });
              core.info(`Created PR: ${res.data.html_url}`);
            }
